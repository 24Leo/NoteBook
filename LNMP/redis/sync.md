主死从上，主恢复过来后需要和从同步。
    * slave 会记住旧 master 的旧 replication ID 和复制偏移量

##同步过程
* 下载redis源码，然后编译两份redis放到不同的目录下，其中一份当作server端口为9000，另一份为客户端端口为8999。
* 当然为了方便追踪，我们可以在编译源代码之前添加一些日志或其他返回值，这样方便跟踪。

我们可以执行slaveof IP:PORT之后，就会发现返回就完事了，但是redis客户端需要和服务器进行复杂的底层交互，这个对用户是透明的，涉及到的命令有ping、psync（以前是sync，现在两者都支持）。
###从服务器状态机
* 定时调用replicationCron方法
    * 频率可以设置，默认是1s一次
    
    
    
    
    
###主服务器状态机


[return](README.md)


